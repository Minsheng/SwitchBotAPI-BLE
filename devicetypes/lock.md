# Lock BLE Open API

## Lock Broadcast Message
The following table is the Service Data of SCAN_RSP.

### ADV AD Structure

| ADV AD Structure |      |           |                            |                                                                                                                                                                                                                         |                                                                                                              |
| ---------------- | ---- | --------- | -------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------ |
| AD Structure 1   | len  | Byte 0    |                            | 0x02                                                                                                                                                                                                                    |                                                                                                              |
|                  | type | Byte 1    | Flags                      | 0x01                                                                                                                                                                                                                    |                                                                                                              |
|                  | data | Byte 2    |                            | 0x06                                                                                                                                                                                                                    |                                                                                                              |
| AD Structure 2   | len  | Byte 3    |                            |                                                                                                                                                                                                                         |                                                                                                              |
|                  | type | Byte 4    | Company ID                 | 0xff                                                                                                                                                                                                                    |                                                                                                              |
|                  | data | Byte 5~6  |                            | 0x0969                                                                                                                                                                                                                  |                                                                                                              |
|                  |      | Byte 7~13 | MAC Address                | Device MAC Address                                                                                                                                                                                                      |                                                                                                              |
|                  |      | Byte 14   | Sequence Number            | [1,255]                                                                                                                                                                                                                 | 1~255 increases, 256 overflow is 1, and the broadcast packet data automatically increases when it is updated |
|                  |      | Byte 15   | Lock Info                  | Bit7 Calibration status： 0-Not calibrated 1-Calibrated                                                                                                                                                                 |                                                                                                              |
|                  |      |           |                            | Bit6-4 Lock Status:<br/>000b - Locked<br/>001b - Unlocked<br/>010b - Locking<br/>011b - Unlocking<br/>100b - LockingStop（Stuck）<br/>101b - UnlockingStop（Stuck）<br/>110b - Not fully locked（only for EU Lock Type) | This status is invalid when not calibrated                                                                   |
|                  |      |           |                            | Bit3 Door status update source:<br/>0-Update from Primary lock<br/>1-Update from Secondary lock<br/>Bit2 Door status:<br/>0-Closed<br/>1-Opened                                                                         | Only for Double Lock Mode                                                                                    |
|                  |      |           |                            | Bit1-0 Reserve                                                                                                                                                                                                          |                                                                                                              |
|                  |      | Byte 16   | Double lock control source | Bit7 Double Lock Mode:  0-Off 1-On                                                                                                                                                                                      | Only for Double Lock Mode                                                                                    |
|                  |      |           |                            | Bit6 Reserve                                                                                                                                                                                                            |                                                                                                              |
|                  |      |           |                            | Bit5 Unclosed door timeout alarm: 0-Off 1-On                                                                                                                                                                            |                                                                                                              |
|                  |      |           |                            | Bit4 Unlocked timeout alarm: 0-Off 1-On                                                                                                                                                                                 |                                                                                                              |
|                  |      |           |                            | Bit3-2 Reserve                                                                                                                                                                                                          |                                                                                                              |
|                  |      |           |                            | Bit1 Pause Automatic Locking Status:  0 inactived; 1: activated                                                                                                                                                         |                                                                                                              |
|                  |      |           |                            | Bit0 Reserve                                                                                                                                                                                                            |                                                                                                              |
|                  |      | Byte 17   | Reserve                    | Reserve                                                                                                                                                                                                                 |

### SCAN RSP AD Structure

| SCAN RSP AD Structure |      |        |              |                                                 |     |
| --------------------- | ---- | ------ | ------------ | ----------------------------------------------- | --- |
| AD Structure 1        | len  |        |              |                                                 |     |
|                       | type |        | Service Data | 0x16                                            |     |
|                       | data | Byte 0 | Device Type  | Bit7 Reserve                                    |     |
|                       |      |        |              | Bit6-0 Device Type<br/>'o' (0x6F)： Normal Mode |     |
|                       |      | Byte 1 | Reserve      | Reserve                                         |     |
|                       |      | Byte 2 | Battery      | Bit7 Reserve                                    |     |
|                       |      |        |              | Bit6-0 battery voltage 0~100%                   |     |

